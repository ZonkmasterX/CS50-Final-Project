{% extends "layout.html" %}

{% block title %}
  Movie and Show Search
{% endblock %}

{% block main %}
  <script>
    function loadinputs() {
      document.getElementById("criticscore").oninput = function() {
      document.getElementById("criticvalue").innerHTML = this.value;
      }

      document.getElementById("userscore").oninput = function() {
      document.getElementById("uservalue").innerHTML = this.value;
      }

      document.getElementById("length").oninput = function() {
      document.getElementById("lengthvalue").innerHTML = this.value;
      }

      document.getElementById("preferredlength").oninput = function() {
      document.getElementById("plengthvalue").innerHTML = this.value;
      }

      document.getElementById("moviescheck").oninput = function() {
        if (this.checked) {
          document.getElementById("moviepreferences").style.display = "block"
          if (document.getElementById("tvcheck").checked) {
            document.getElementById("recommend").disabled = false
            document.getElementById("recommend").value = "Recommend Movies and Shows"
          }
          else {
            document.getElementById("recommend").disabled = false
            document.getElementById("recommend").value = "Recommend Movies"
          }
        }
        else {
          document.getElementById("moviepreferences").style.display = "none"
          if (document.getElementById("tvcheck").checked) {
            document.getElementById("recommend").disabled = false
            document.getElementById("recommend").value = "Recommend Shows"
          }
          else {
            document.getElementById("recommend").disabled = true
            document.getElementById("recommend").value = "Select a Category First"
          }
        }
      }

      document.getElementById("tvcheck").oninput = function() {
        if (this.checked) {
          document.getElementById("tvpreferences").style.display = "block"
          if (document.getElementById("moviescheck").checked) {
            document.getElementById("recommend").disabled = false
            document.getElementById("recommend").value = "Recommend Movies and Shows"
          }
          else {
            document.getElementById("recommend").disabled = false
            document.getElementById("recommend").value = "Recommend Shows"
          }
        }
        else {
          document.getElementById("tvpreferences").style.display = "none"
          if (document.getElementById("moviescheck").checked) {
            document.getElementById("recommend").disabled = false
            document.getElementById("recommend").value = "Recommend Movies"
          }
          else {
            document.getElementById("recommend").disabled = true
            document.getElementById("recommend").value = "Select a Category First"
          }
        }
      }
    }

    function recommend() {
      // load all the relevant variables (Incomplete)
      var criticvalue = document.getElementById("criticvalue").value
      var uservalue = document.getElementById("uservalue").value
      var lengthvalue = document.getElementById("lengthvalue").value
      var moviescheck = document.getElementById("moviescheck").checked
      var tvcheck = document.getElementById("tvcheck").checked

      if (moviescheck) {
        var preferredlength = document.getElementById("preferredlength").value

        // handle ratings
        var selectedRatings = {}
        var ratings = document.querySelectorAll(".rating")
        for (var i = 0, n = ratings.length; i < n; i++) {
          selectedRatings[ratings[i].value] = ratings[i].checked
        }
      }

      // TODO: do some sql stuff
      // TODO: do the fancy math
      // TODO: render the cells of the table
    }

    document.addEventListener("DOMContentLoaded", loadinputs)

  </script>
  <div class="inputs">
    <h3>How much do you value the following things?</h3>
    <p>0 means you do not care at all and 10 means you care a lot<p>

    Critic Score <input type="range" min="0" max="10" value="0" class="slider" id="criticscore"> <span id="criticvalue">0</span>
    User Score <input type="range" min="0" max="10" value="0" class="slider" id="userscore"> <span id="uservalue">0</span>
    Length <input type="range" min="0" max="10" value="0" class="slider" id="length"> <span id="lengthvalue">0</span>

    <h3>What are you looking for?</h3>
      <label for="moviescheck"> Movies </label>
      <input type="checkbox" id="moviescheck" name="moviescheck" value="MoviesCheck">

      <label for="tvcheck"> TV Shows </label>
      <input type="checkbox" id="tvcheck" name="tvcheck" value="TVCheck">

    <div id="moviepreferences" style="display:none;">

      <h4>Movie Preferences</h4>

      Preferred Length <input type="range" min="0" max="240" value="120" class="slider" id="preferredlength"> <span id="plengthvalue">120</span> minutes
      <br>

      Rating:
        <label for="g"> G </label>
        <input class="rating" type="checkbox" id="g" name="g" value="G">

        <label for="pg"> PG </label>
        <input class="rating" type="checkbox" id="pg" name="pg" value="PG">

        <label for="pg-13"> PG-13 </label>
        <input class="rating" type="checkbox" id="pg-13" name="pg-13" value="PG-13">

        <label for="r"> R</label>
        <input class="rating" type="checkbox" id="r" name="r" value="R">
      </div>

    <div id="tvpreferences" style="display:none;">
      <h4>TV Show Preferences</h4>
    </div>

    <br>
    <input id="recommend" type="button" disabled value="Select a Category First" onclick="recommend()">



  </div>
{% endblock %}
